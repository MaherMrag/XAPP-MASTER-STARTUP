<style>
    input.series-color {
        width: 100px;
        text-align: center;
    }

    input.series-color::-webkit-color-swatch {
        border: none;
    }
</style>
<script type="text/javascript">
    RED.nodes.registerType('ui.barchart', {
        category: 'S7',
        defaults: {
            name: { value: '' },
            order: { value: 0 },
            parentid: { value: 0 },
            datapoints: { value: {} },
            width: { value: 0 },
            height: { value: 0 },
            x: { value: 0 },
            y: { value: 0 },
            label: { value: 'chart' },
            legend: { value: 'false' },
            colors: { value: ['#1F77B4', '#AEC7E8', '#FF7F0E', '#2CA02C', '#98DF8A', '#D62728', '#FF9896', '#9467BD', '#C5B0D5'] },
            chartType: { value: 'line' },
            Unit: { value: 'Days' },
            xformat: { value: 'HH:mm:ss' },

            title: { value: "title" },
            subtitle: { value: 'subtitle' },
            title_alignvertical: { value: 'top' },
            title_alignhorizontal: { value: 'left' },
            show_title: { value: true },
            show_toolbox: { value: true },
            toolbox_alignvertical: { value: 'top' },
            toolbox_alignhorizontal: { value: 'left' },
            toolbox_orientation: { value: 'horizontal' },

            show_legend: { value: true },
            legend_alignvertical: { value: 'top' },
            legend_alignhorizontal: { value: 'left' },
            legend_orientation: { value: 'horizontal' },

            grid_top: { value: 5 },
            grid_bottom: { value: 5 },
            grid_left: { value: 5 },
            grid_right: { value: 5 },

            xname: { value: '' },
            xunit: { value: '' },
            xsplitline: { value: false },
            xsplitarea: { value: false },
            xaxistick: { value: false },
            xaxisline: { value: false },


            yname: { value: '' },
            yunit: { value: '' },
            ysplitline: { value: false },
            ysplitarea: { value: false },
            yaxistick: { value: false },
            yaxisline: { value: false },

            mark_min_show: { value: false },
            mark_max_show: { value: false },
            mark_average_point_show: { value: false },
            mark_average_line_show: { value: false },

            mark_line: { value: '' },
            mark_Area_min: { value: '' },
            mark_Area_max: { value: '' },

        },
        inputs: 1,
        outputs: 1,
        oneditprepare: function () {
            var node = this;


            $("#node-input-size").elementSizer({
                width: "#node-input-width",
                height: "#node-input-height",
                maxWidth: 12,
                maxHeight: 7,

                fixedHeight: false,
                fixedWidth: true,
            });


            var defaultColors = ['#1F77B4', '#AEC7E8', '#FF7F0E', '#2CA02C', '#98DF8A', '#D62728', '#FF9896', '#9467BD', '#C5B0D5'];
            var setColour = function (id, value) {
                $(id).val(value);
                $(id).css("background-color", value);
                var rgb = tinycolor(value).toRgb();
                var level = ((rgb.r * 299) + (rgb.g * 587) + (rgb.b * 114)) / 1000;
                var textColor = (level >= 128) ? '#111111' : '#eeeeee';
                $(id).css("color", textColor);
            }




            var i = 0;
            var container = $('#series-items');

            for (id in node.datapoints) {

                if (node.datapoints.hasOwnProperty(id)) {
                    /* var data = node.payload[id]; */
                    i++;
                    var item = $(`<div class="form-row" id="${id}" style="margin-bottom: 5px;" ></div>`);
                    var label = $(`<label for="node-input-removeOlder">Serie 0${i} : </label>`);
                    var name = $(`<input type="text" id="${node.datapoints[id].id}" placeholder="${node.datapoints[id].name}" disabled autocomplete="off" style="width:40%;" >`);


                    var color = $(`<input type="color" id="node-input-color0${i}" class="series-color" style="margin-left:5px; margin-right:5px; width:100px;"/>`).val('#2CA02C');//node.payload[id].color);

                    item.append(label);
                    item.append(name);
                    item.append(color);

                    container.append(item);


                    if (node.datapoints[id].color) {
                        setColour("#node-input-color0" + i, node.datapoints[id].color);
                    }
                    else {
                        setColour("#node-input-color0" + i, defaultColors[i]);
                    }
                }
            }



            $(".series-color").on("change", function () {
                setColour("#" + $(this).attr("id"), $(this).val());
            });


            var oval = $("#node-input-xformat").val();
            if (!oval) { $("#node-input-xformat").val("HH:mm:ss"); }
            var odef = 'custom';
            if (oval === "HH:mm:ss") { odef = oval; }
            if (oval === "HH:mm") { odef = oval; }
            if (oval === "Y-M-D") { odef = oval; }
            if (oval === "D/M") { odef = oval; }
            if (oval === "dd HH:mm") { odef = oval; }
            if (oval === "auto") { odef = oval; }
            var ohms = { value: "HH:mm:ss", label: "HH:mm:ss", hasValue: false };
            var ohm = { value: "HH:mm", label: "HH:mm", hasValue: false };
            var oymd = { value: "Y-M-D", label: "Year-Month-Date", hasValue: false };
            var odm = { value: "D/M", label: "Date/Month", hasValue: false };
            var oahm = { value: "dd HH:mm", label: "Day HH:mm", hasValue: false };
            var ocus = { value: "custom", label: "custom", icon: "red/images/typedInput/az.png" };
            var oaut = { value: "auto", label: "automatic", hasValue: false };
            $("#node-input-xformat").typedInput({
                default: odef,
                types: [ohms, ohm, oahm, odm, oymd, ocus, oaut]
            });

        },
        oneditsave: function () {
            var node = this;
            if ($("#node-input-xformat").typedInput('type') !== 'custom') {
                $("#node-input-xformat").val($("#node-input-xformat").typedInput('type'));
            }

            node.payload = {};
            var id, name, color;
            $('#series-items').children().each((index, items) => {
                $(items).children().each((i, item) => {
                    switch (i) {
                        case 1: id = $(item).val(); name = $(item).text().trim();
                        case 2: color = $(item).val();
                    }
                })
                node.payload[id] = { id: id, name: name, color: color };
            });
            this.Unit = $("#node-input-Unit").val();
            this.xformat = $("#node-input-xformat").val();
            node._def.oncomponentload.call(node);

        },
        onwsprepare: function () {
            var container = $(`
                            <div class="col-md-${this.width} col-sm-${this.width / 2}">

                            </div> 
                        `);

            /* var chart = $(`<div id="echart_pie" style="min-height: 300px; height: 100%;  max-width: 100%;"></div>`); */
            var chart = $(`<canvas id="donutChart1" style="min-height: 250px; height: 100%; max-height: 100%; max-width: 100%;"></canvas>`);
            container.append(chart);


            return container;
        },
        oncomponentload: function (dt) {
            var nn = this;

            var _id = nn.id;
            if (dt) {
                nn.date = dt;
            }
            var unit = nn.Unit;
            var date = dt || nn.date;
            if (!date) return;
            var datapoints = nn.datapoints;


            var item_id = nn.id.replace(".", "-");

            var xformat = nn.xformat;
            var height = nn.height;

            var gridstack_item_content = $(`#${item_id}-item-content`);
            gridstack_item_content.empty();
            gridstack_item_content.addClass('card');
            //var card_item = $(`<div class="card">`).appendTo(gridstack_item_content)

            var card_header = $(`<div class="card-header">
                                    <h3 class="card-title"><i class="ion ion-stats-bars"></i> ${nn.name}</h3>

                                    <div class="card-tools">
                                        <button type="button" class="btn btn-tool" data-card-widget="card-refresh" data-source="widgets.html" data-source-selector="#card-refresh-content" data-load-on-init="false"><i class="fas fa-sync-alt"></i></button>
                                        <button id="${item_id}-btn-maximize" type="button" class="btn btn-tool"><i class="fas fa-expand"></i></button>
                                        <button type="button" class="btn btn-tool" data-card-widget="collapse"><i class="fas fa-minus"></i></button>
                                        <button type="button" class="btn btn-tool" data-card-widget="remove"><i class="fas fa-times"></i></button>
                                    </div>
                                    <!-- /.card-tools -->
                                </div>`).on("dblclick", function () { RED.editor.edit(nn); }).appendTo(gridstack_item_content);





            var component_content = $(`<div class="card-body">`).appendTo(gridstack_item_content);
            var card_footer = $(`<div class="card-footer">`).appendTo(gridstack_item_content);

            var btn_maximise = $(`#${item_id}-btn-maximize`).click(function (evt) {
                const element = document.getElementById(`${item_id}`);

                element.webkitRequestFullScreen();
            });



            var chart_component = `<div id='${item_id}-chart' style='height: 100%;width: 100%; '></div>`




            function show_spinner() {
                component_content.empty();
                var spinner = $(`<div id ='${item_id}-spinner'  class='tp-spinner'>
														<span class='tb-spinner tb-spinner-is-centered'> </span>
                                                    </div>`).appendTo(component_content)
            }

            function load_data() {
                var data = { date: date, unit: unit, datapoints: datapoints }
                show_spinner();
                $.ajax({
                    method: 'POST',
                    contentType: 'application/json',
                    url: "barchart/" + nn.id,
                    data: JSON.stringify(data),
                    success: function (data) {
                        init_chart(data)
                       //  init_table(data)
                  

                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log("Unexpected error saving user settings:", jqXHR.status, textStatus);
                    }
                });
            }

            function init_table(data) {



                var table_container = $(`<div class="vallis" style="width:100%">`)
                var table_item = $(`<table id="_datatable" class="table table-striped  table-hover table-bordered " style="width:100%;height='auto'">`).appendTo(table_container);
                var head_item = $(`<thead></thead>
                                `).appendTo(table_item)

                var item_tr = $(`<tr>`).appendTo(head_item)
                var item_date = $(`<th>Date/Heure</th>`).appendTo(item_tr)
                data.datasets.data.forEach((d) => {
                    var item_datapoint = $(`<th>${d.name}</th>`).appendTo(item_tr)
                })

                var footer_item = $(`
                                    <tfoot>
                                        <tr>
                                            <td>Totals</td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tfoot>`).appendTo(table_item)

                var body_item = $(`<tbody>`).appendTo(table_item)
                //${item_id}
                var matrice = [];
                var i = 1;
                data.datasets.data.forEach((d) => {

                    xAxisData = [];
                    seriesData = [];
                    var serie = {};

                    var j = 0;
                    matrice[i] = []
                    matrice[0] = []
                    for (id in d.result) {
                        if (d.result.hasOwnProperty(id)) {
                            matrice[i][j] = parseFloat(d.result[id].value);
                            matrice[0][j] = moment(new Date(d.result[id].date)).format(xformat);

                            j++;
                        }
                    }
                    i++;
                })



                for (var i = 0; i < matrice[0].length; i++) {

                    var item_tr = $(`<tr></tr>`).appendTo(body_item);
                    for (var j = 0; j < matrice.length; j++) {
                        var item_td = $(`<td>${matrice[j][i]}</td>`).appendTo(item_tr)
                    }



                }


                /* for (id in xAxisData) {
                    if (xAxisData.hasOwnProperty(id)) {
                        var item = $(`<tr>
                                <td>${xAxisData[id]}</td>
                                <td>${xAxisData[id]}</td>
                                <td>${seriesData[id]}</td>
                              </tr>`).appendTo(body_item)
                    }
                } */

                component_content.empty();

                /* table_item.append(head_item)
                table_item.append(body_item) */
                // table_container.append(table_item)
                component_content.append(table_container);

                $('#_datatable').DataTable({
                    "paging": true,
                    "scrollY": "294px",
                    "scrollCollapse": true,
                    "lengthChange": true,
                    "searching": false,
                    "ordering": true,
                    "info": false,
                    "autoWidth": true,
                    "responsive": true,
                    "footerCallback": function (row, data, start, end, display) {
                        var api = this.api();
                        nb_cols = api.columns().nodes().length;
                        var j = 1;
                        while (j < nb_cols) {
                            var pageTotal = api
                                .column(j, { page: 'current' })
                                .data()
                                .reduce(function (a, b) {
                                    return Number(a) + Number(b);
                                }, 0);
                            // Update footer
                            $(api.column(j).footer()).html(pageTotal);
                            j++;
                        }
                    }
                });

                var table = $('#_datatable').DataTable();



            }
            function init_chart(data) {
                var theme = {
                    color: [
                        '#26B99A', '#34495E', '#BDC3C7', '#3498DB',
                        '#9B59B6', '#8abb6f', '#759c6a', '#bfd3b7'
                    ],

                    title: {
                        itemGap: 8,
                        textStyle: {
                            fontWeight: 'normal',
                            color: '#408829'
                        }
                    },

                    dataRange: {
                        color: ['#1f610a', '#97b58d']
                    },

                    toolbox: {
                        color: ['#408829', '#408829', '#408829', '#408829']
                    },

                    tooltip: {
                        backgroundColor: 'rgba(0,0,0,0.5)',
                        axisPointer: {
                            type: 'line',
                            lineStyle: {
                                color: '#408829',
                                type: 'dashed'
                            },
                            crossStyle: {
                                color: '#408829'
                            },
                            shadowStyle: {
                                color: 'rgba(200,200,200,0.3)'
                            }
                        }
                    },

                    dataZoom: {
                        dataBackgroundColor: '#eee',
                        fillerColor: 'rgba(64,136,41,0.2)',
                        handleColor: '#408829'
                    },
                    grid: {
                        borderWidth: 0
                    },

                    categoryAxis: {
                        axisLine: {
                            lineStyle: {
                                color: '#408829'
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                color: ['#eee']
                            }
                        }
                    },

                    valueAxis: {
                        axisLine: {
                            lineStyle: {
                                color: '#408829'
                            }
                        },
                        splitArea: {
                            show: true,
                            areaStyle: {
                                color: ['rgba(250,250,250,0.1)', 'rgba(200,200,200,0.1)']
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                color: ['#eee']
                            }
                        }
                    },
                    timeline: {
                        lineStyle: {
                            color: '#408829'
                        },
                        controlStyle: {
                            normal: { color: '#408829' },
                            emphasis: { color: '#408829' }
                        }
                    },

                    k: {
                        itemStyle: {
                            normal: {
                                color: '#68a54a',
                                color0: '#a9cba2',
                                lineStyle: {
                                    width: 1,
                                    color: '#408829',
                                    color0: '#86b379'
                                }
                            }
                        }
                    },
                    map: {
                        itemStyle: {
                            normal: {
                                areaStyle: {
                                    color: '#ddd'
                                },
                                label: {
                                    textStyle: {
                                        color: '#c12e34'
                                    }
                                }
                            },
                            emphasis: {
                                areaStyle: {
                                    color: '#99d2dd'
                                },
                                label: {
                                    textStyle: {
                                        color: '#c12e34'
                                    }
                                }
                            }
                        }
                    },
                    force: {
                        itemStyle: {
                            normal: {
                                linkStyle: {
                                    strokeColor: '#408829'
                                }
                            }
                        }
                    },
                    chord: {
                        padding: 4,
                        itemStyle: {
                            normal: {
                                lineStyle: {
                                    width: 1,
                                    color: 'rgba(128, 128, 128, 0.5)'
                                },
                                chordStyle: {
                                    lineStyle: {
                                        width: 1,
                                        color: 'rgba(128, 128, 128, 0.5)'
                                    }
                                }
                            },
                            emphasis: {
                                lineStyle: {
                                    width: 1,
                                    color: 'rgba(128, 128, 128, 0.5)'
                                },
                                chordStyle: {
                                    lineStyle: {
                                        width: 1,
                                        color: 'rgba(128, 128, 128, 0.5)'
                                    }
                                }
                            }
                        }
                    },
                    gauge: {
                        startAngle: 225,
                        endAngle: -45,
                        axisLine: {
                            show: true,
                            lineStyle: {
                                color: [[0.2, '#86b379'], [0.8, '#68a54a'], [1, '#408829']],
                                width: 8
                            }
                        },
                        axisTick: {
                            splitNumber: 10,
                            length: 12,
                            lineStyle: {
                                color: 'auto'
                            }
                        },
                        axisLabel: {
                            textStyle: {
                                color: 'auto'
                            }
                        },
                        splitLine: {
                            length: 18,
                            lineStyle: {
                                color: 'auto'
                            }
                        },
                        pointer: {
                            length: '90%',
                            color: 'auto'
                        },
                        title: {
                            textStyle: {
                                color: '#333'
                            }
                        },
                        detail: {
                            textStyle: {
                                color: 'auto'
                            }
                        }
                    },
                    textStyle: {
                        fontFamily: 'Arial, Verdana, sans-serif'
                    }
                };



                component_content.empty();
                component_content.append(chart_component);

                if (chart_component.length) {

                    var echartBar = echarts.init(document.getElementById(`${item_id}-chart`), theme);




                    var title = {
                        show: nn.show_title,
                        text: nn.title,
                        subtext: nn.subtitle,
                        left: nn.title_alignhorizontal,
                        top: nn.title_alignvertical,
                    };

                    var toolbox = {
                        show: nn.show_toolbox,
                        orient: nn.toolbox_orientation,
                        left: nn.toolbox_alignhorizontal,
                        top: nn.toolbox_alignvertical,
                        feature: {
                            magicType: {
                                show: true,
                                title: {
                                    line: 'Line',
                                    bar: 'Bar',
                                    stack: 'Stack',
                                    tiled: 'Tiled'
                                },
                                type: ['line', 'bar', 'stack', 'tiled']
                            },
                            restore: {
                                show: true,
                                title: "Restore"
                            },
                            saveAsImage: {
                                show: true,
                                title: "Save Image"
                            },
                            dataZoom: {
                                yAxisIndex: 'none',
                                title: 'Zoom'
                            },
                            myfeature: {
                                show: true,
                                title: 'Maximize',
                                icon: 'path://M432.45,595.444c0,2.177-4.661,6.82-11.305,6.82c-6.475,0-11.306-4.567-11.306-6.82s4.852-6.812,11.306-6.812C427.841,588.632,432.452,593.191,432.45,595.444L432.45,595.444z M421.155,589.876c-3.009,0-5.448,2.495-5.448,5.572s2.439,5.572,5.448,5.572c3.01,0,5.449-2.495,5.449-5.572C426.604,592.371,424.165,589.876,421.155,589.876L421.155,589.876z M421.146,591.891c-1.916,0-3.47,1.589-3.47,3.549c0,1.959,1.554,3.548,3.47,3.548s3.469-1.589,3.469-3.548C424.614,593.479,423.062,591.891,421.146,591.891L421.146,591.891zM421.146,591.891',
                                onclick: function () {
                                    const element = document.getElementById(`${item_id}`);

                                    element.webkitRequestFullScreen();
                                }
                            },
                        }
                    };

                    var tooltip = {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'cross', // 'line' | 'shadow'
                            animation: true,
                        },
                        /* formatter: function (params) {
                            params = params[0];
                            var date = new Date(params.name);
                            return date.getDate() + '/' + (date.getMonth() + 1) + '/' + date.getFullYear() + ' : ' + params.value;
                        },
                        position: function (pt) {
                            return [pt[0], '10%'];
                        }, */
                    };

                    var legend = {
                        show: nn.show_legend,
                        orient: nn.legend_orientation,
                        left: nn.legend_alignhorizontal,
                        top: nn.legend_alignvertical,
                        data: []
                    };

                    legend.data = data.legend;
     
                    var grid = {
                        left: nn.grid_left,
                        right: nn.grid_right,
                        bottom: nn.grid_bottom,
                        top: nn.grid_top,
                        containLabel: true
                    };

                    var xAxis = {
                        name: nn.xname,
                        axisLabel: {
                            formatter: '{value}' + nn.xunit, textStyle: {
                                color: '#999'
                            }
                        },
                        type: 'category',
                        boundaryGap: true,
                        splitLine: { show: nn.xsplitline },
                        splitArea: { show: nn.xsplitarea },
                        axisTick: { show: nn.xaxistick },
                        axisLine: { show: nn.xaxisline },
                        data: []
                    };

                    var yAxis = {
                        name: nn.yname,
                        axisLabel: {
                            formatter: '{value} ' + nn.yunit, textStyle: {
                                color: '#999'
                            }
                        },
                        type: 'value',
                        boundaryGap: false,
                        splitLine: { show: nn.ysplitline },
                        splitArea: { show: nn.ysplitarea },
                        axisTick: { show: nn.yaxistick },
                        axisLine: { show: nn.yaxisline },

                    };

                    var dataZoom = [{show:true,realtime:true,start:0,end:100},{ type: 'inside' },{ type: 'slider' }];

        



                    var markPoint = { data: [] };
                    if (nn.mark_min_show) { markPoint.data.push({ type: 'min', name: 'min' }); }
                    if (nn.mark_max_show) { markPoint.data.push({ type: 'max', name: 'max' }); }
                    if (nn.mark_average_point_show) { markPoint.data.push({ type: 'average', name: 'average' }); }

                    var markLine = { silent: true, data: [] };
                    if (nn.mark_line) { markLine.data.push({ yAxis: parseFloat(nn.mark_line) }) }

                    if (nn.mark_average_line_show) { markLine.data.push({ type: 'average', name: 'average' }); }




                    var markArea = { silent: true, data: [] }
                    if (nn.mark_Area_min && nn.mark_Area_max) {
                        markArea.data.push({ yAxis: '9000000'/* parseFloat(nn.mark_Area_min) */ });
                        markArea.data.push({ yAxis: '12000000'/* parseFloat(nn.mark_Area_max) } */ });
                    }
                    var seriesData = [];
                    var series = []
                    var xAxisData = [];



                    data.datasets.data.forEach((d) => {
                        xAxisData = [];
                        seriesData = [];
                        var serie = {};


                        for (id in d.result) {
                            if (d.result.hasOwnProperty(id)) {
                                xAxisData.push(moment(new Date(d.result[id].date)).format(xformat));
                                seriesData.push(d.result[id].value)
                            }
                        }

                        serie = { name: d.name, type: 'bar', data: seriesData, markPoint: markPoint, markLine: markLine, markArea: markArea }
                        series.push(serie)
                        xAxis.data = xAxisData;

                    })




                    xAxis.data = xAxisData;
                    options = {
                        calculable: true,
                        title: title,
                        legend: legend,
                        toolbox: toolbox,
                        tooltip: tooltip,
                        dataZoom: dataZoom,
                        grid: grid,
                        xAxis: xAxis,
                        yAxis: yAxis,
                        series: series
                    }

    
                    echartBar.setOption(options);
                    component_content.parent().on("resize", function () {
                        echartBar.resize();

                    })

                }





















                /* 
                                        var chart_id = nn.id.replace(".", "-");
                                        if ($('#' + chart_id).length) {
                                            var donutChartCanvas = $('#' + chart_id).get(0).getContext('2d')
                
                                            var donutData = {};
                                            donutData.labels = data.labels;
                                            donutData.datasets = data.datasets;
                
                                            var donutOptions = {
                                                maintainAspectRatio: false,
                                                responsive: true,
                                            }
                                            //Create pie or douhnut chart
                                            // You can switch between pie and douhnut using the method below.
                                            var donutChart = new Chart(donutChartCanvas, {
                                                type: 'doughnut',
                                                data: donutData,
                                                options: donutOptions
                                            })
                                        } */
            }

            load_data();
        },

    });
</script>

<script type="text/html" data-template-name="ui.barchart">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" />
    </div>
    
    <div class="form-row" style="display: none;">
        <label for="node-input-group"><i class="fa fa-table"></i> Group</label>
        <input type="text" id="node-input-group" />
    </div>
    
    <hr />
    <div class="form-row">
        <label><i class="fa fa-object-group"></i> Size</label>
        <input type="hidden" id="node-input-width" />
        <input type="hidden" id="node-input-height" />
        <button class="editor-button" id="node-input-size"></button>
    </div>
    
    <hr />
    <div class="form-row">
        <label for="node-input-show_title">Show title </label>
        <input type="checkbox" id="node-input-show_title" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    <div class="form-row">
        <label for="node-input-label">Title </label>
        <input type="text" id="node-input-title" placeholder="title" />
    </div>
    
    <div class="form-row">
        <label for="node-input-label">Sub title </label>
        <input type="text" id="node-input-subtitle" placeholder="Sub title" />
    </div>
    
    <div class="form-row">
        <label for="node-input-alignement-title">Alignement </label>
        <select id="node-input-title_alignvertical" style="width: 30%;">
             <option value="top">top</option>
            <option value="center">center</option>
            <option value="bottom">bottom</option>
        </select>
    
        <select id="node-input-title_alignhorizontal" style="width: 30%;">
            <option value="left">left</option>
            <option value="right">right</option>
            <option value="center">center</option>
        </select>
    </div>
    

    
    <hr >
    <div class="form-row">
        <label for="node-input-show_toolbox">Show toolbox </label>
        <input type="checkbox" id="node-input-show_toolbox" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    
    <div class="form-row">
        <label for="node-input-alignement-toolbox">Alignement </label>
    
        <select id="node-input-toolbox_alignvertical" style="width: 30%;">
            <option value="top">top</option>
            <option value="center">center</option>
            <option value="bottom">bottom</option>
        </select>
    
        <select id="node-input-toolbox_alignhorizontal" style="width: 30%;">
            <option value="left">left</option>
            <option value="right">right</option>
            <option value="center">center</option>
        </select>
    </div>
    
    <div class="form-row">
        <label for="node-input-alignement-toolbox">Orientation </label>
        <select id="node-input-toolbox_orientation" style="width: 30%;">
            <option value="horizontal">horizontal</option>
            <option value="vertical">vertical</option>
        </select>
    </div>
    
    <hr >
    <div class="form-row">
        <label for="node-input-show_legend">Show legend </label>
        <input type="checkbox" id="node-input-show_legend" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    
    <div class="form-row">
        <label for="node-input-alignement-legend">Alignement </label>
    
        <select id="node-input-legend_alignvertical" style="width: 30%;">
            <option value="top">top</option>
            <option value="center">center</option>
            <option value="bottom">bottom</option>
        </select>
    
        <select id="node-input-legend_alignhorizontal" style="width: 30%;">
            <option value="left">left</option>
            <option value="center">center</option>
            <option value="right">right</option>
        </select>
    </div>
    
    <div class="form-row">
        <label for="node-input-alignement-legend">Orientation </label>
        <select id="node-input-legend_orientation" style="width: 30%;">
            <option value="horizontal">horizontal</option>
            <option value="vertical">vertical</option>
        </select>
    </div>

    <hr />
    <div class="form-row">
    <label for="node-input-grid">Grid </label>
</div>
    <div class="form-row">

        <label for="node-input-grid_top">Top </label>
        <input type="text" id="node-input-grid_top" style="width: 268px;"  />

        <label for="node-input-grid_bottom">bottom </label>
        <input type="text" id="node-input-grid_bottom" style="width: 268px;" />

        <label for="node-input-grid_left">left </label>
        <input type="text" id="node-input-grid_left" style="width: 268px;" />

        <label for="node-input-grid_right">right </label>
        <input type="text" id="node-input-grid_right" style="width: 268px;" />
    </div>


    <hr />
    
    <div class="form-row">
        <label for="node-input-chartType"> Type</label>
        <select id="node-input-chartType" style="font-family: 'FontAwesome', 'Helvetica Neue', Helvetica, Arial, sans-serif;">
            <option value="line"> &#xf201; Line chart</option>
            <option value="bar"> &#xf080; Bar chart</option>
            <option value="horizontalBar"> &#xf080; Bar chart (H)</option>
        </select>
    </div>
    <hr /> 


    <div class="form-row" id="x-axis-label-show">
        <label for="node-input-xformat">X-axis</label>
        <input type="text" id="node-input-xformat" style="width: 268px;" />
        <select id="node-input-Unit" style="width: 100px;">
            <option value="Seconds">Seconds</option>
            <option value="Minutes">Minutes</option>
            <option value="Hours">Hours</option>
            <option value="Days">Days</option>
            <option value="Month">Month</option>
        </select>
    </div>

    <div class="form-row">
        <label for="node-input-xname">xname </label>
        <input type="text" id="node-input-xname" style="width: 268px;" />
    </div>

    <div class="form-row">
        <label for="node-input-xunit">xunit </label>
        <input type="text" id="node-input-xunit" style="width: 268px;" />
    </div>

    <div class="form-row">
        <label for="node-input-xsplitline"> Xsplitline </label>
        <input type="checkbox" id="node-input-xsplitline" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    
    <div class="form-row">
        <label for="node-input-xsplitarea"> xsplitarea </label>
        <input type="checkbox" id="node-input-xsplitarea" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>

    <div class="form-row">
        <label for="node-input-xaxistick"> xaxistick </label>
        <input type="checkbox" id="node-input-xaxistick" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>

    <div class="form-row">
        <label for="node-input-xaxisline"> xaxisline </label>
        <input type="checkbox" id="node-input-xaxisline" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    <hr />
    
    <div class="form-row">
        <label for="node-input-yname">yname </label>
        <input type="text" id="node-input-yname" style="width: 268px;" />
    </div>

    <div class="form-row">
        <label for="node-input-yunit">yunit </label>
        <input type="text" id="node-input-yunit" style="width: 268px;" />
    </div>

    <div class="form-row">
        <label for="node-input-ysplitline"> Ysplitline </label>
        <input type="checkbox" id="node-input-ysplitline" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    
    <div class="form-row">
        <label for="node-input-ysplitarea"> Ysplitarea </label>
        <input type="checkbox" id="node-input-ysplitarea" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>

    <div class="form-row">
        <label for="node-input-yaxistick"> Yaxistick </label>
        <input type="checkbox" id="node-input-yaxistick" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>

    <div class="form-row">
        <label for="node-input-yaxisline"> Yaxisline </label>
        <input type="checkbox" id="node-input-yaxisline" style="display: inline-block; width: auto; vertical-align: top;" />
    </div>
    <hr />
    <div class="form-row">
        <label for="node-input-mark_line">Mark line </label>
        <input type="text" id="node-input-mark_line" style="width: 268px;" />
    </div>
    <div class="form-row">
        <label for="node-input-mark_Area_min">Mark Area min </label>
        <input type="text" id="node-input-mark_Area_min" style="width: 268px;" />
    </div>
    <div class="form-row">
        <label for="node-input-mark_Area_max">Mark Area max</label>
        <input type="text" id="node-input-mark_Area_max" style="width: 268px;" />
    </div>
        <div class="form-row">
            <label for="node-input-mark_max_show"> MarkPoint Max </label>
            <input type="checkbox" id="node-input-mark_max_show" style="display: inline-block; width: auto; vertical-align: top;" />
        </div>
        <div class="form-row">
            <label for="node-input-mark_min_show"> MarkPoint Min </label>
            <input type="checkbox" id="node-input-mark_min_show" style="display: inline-block; width: auto; vertical-align: top;" />
        </div>
        <div class="form-row">
            <label for="node-input-mark_average_point_show"> MarkPoint Average </label>
            <input type="checkbox" id="node-input-mark_average_point_show" style="display: inline-block; width: auto; vertical-align: top;" />
        </div>
        <div class="form-row">
            <label for="node-input-mark_average_line_show"> MarkLine Average </label>
            <input type="checkbox" id="node-input-mark_average_line_show" style="display: inline-block; width: auto; vertical-align: top;" />
        </div>
    <hr />





    <div class="form-row">
        <label for="node-input-label"><i class="fa fa-i-cursor"></i> Label</label>
        <input type="text" id="node-input-label" placeholder="optional chart title" />
    </div>
    <div class="form-row" id="legend-show">
        <label for="node-input-legend">Legend</label>
        <select id="node-input-legend" style="width: 120px;">
            <option value="false">None</option>
            <option value="true">Show</option>
        </select>
        <span id="interpolate-show">
            &nbsp;&nbsp;&nbsp;&nbsp;Interpolate
            <select id="node-input-interpolate" style="width: 120px;">
                <option value="linear">linear</option>
                <option value="step">step</option>
                <option value="bezier">bezier</option>
            </select>
        </span>
        <span id="hole-size-show">&nbsp;&nbsp;&nbsp;&nbsp;Cutout <input type="text" id="node-input-cutout" style="width: 35px;" /> % </span>
    </div>
    
    <div id="show-useOneColor" style="display: none; height: 24px;">
        <input type="checkbox" id="node-input-useOneColor" style="display: inline-block; width: auto; vertical-align: baseline; margin-left: 105px; margin-right: 5px;" />Use first colour for all bars
    </div>
    
    <hr />
    <div>Series Items :</div>
    <div class="form-row" id="series-items"></div>
    
</script>

<script type="text/x-red" data-help-name="ui.barchart">
    <p>Plots the input values on a chart. This can either be a time based line chart, a bar chart (vertical or horizontal),
    or a pie chart.</p>
    <p>Each input <code>msg.payload</code> value will be converted to a number. If the
    conversion fails, the message is ignored.</p>
    <p>Minimum and Maximum <b>Y</b> axis values are optional. The graph will auto-scale to any values received.</p>
    <p>Multiple series can be shown on the same chart by using a different <code>msg.topic</code>
    value on each input message. Multiple bars of the same series can be shown by using the <code>msg.label</code> property.</p>
    <p>The <b>X</b> axis defines a time window or a maximum number of points to display. Older data will be automatically removed from the graph.
    The axis labels can be formatted using a <a href="https://momentjs.com/docs/#/displaying/format/" target="_blank">
    Moment.js time formatted</a> string.</p>
    <p>Inputting a <code>msg.payload</code> containing a blank array <code>[]</code> will clear the chart.</p>
    <p>See <b><a href="https://github.com/node-red/node-red-dashboard/blob/master/Charts.md" target="_new">this information</a></b>
    for how to pre-format data to be passed in as a complete chart.</p>
    <p>The <b>Blank label</b> field can be used to display some text before any valid data is received.</p>
    <p>The label can also be set by a message property by setting
    the field to the name of the property, for example <code>{{msg.topic}}</code>.</p>
    <p>The node output contains an array of the chart state that can be persisted if needed. This can be passed
    into the chart node to re-display the persisted data.</p>
</script>